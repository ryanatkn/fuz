import"./DsnmJJEf.js";import{T as He,z as Be,p as xe,i as t,aA as V,f as j,d as L,u as N,s as oe,t as Y,aB as R,b as c,c as ge,r as k,ap as i,az as be,a5 as $,e as ie,g,a as p,h as D,n as Ne,ai as Z,aC as se}from"./B5wh5ago.js";import{i as b}from"./ZkT_IncS.js";import{h as Ce,s as re,b as pe,d as Ge,C as Ve,e as je,j as Ie}from"./CTos7DtZ.js";import{b as Ae}from"./DIiD8fNr.js";import{p as E,r as Ke,s as ye}from"./BFcTPQPt.js";import{s as ue,i as Se,a as Je}from"./V2q5a4YM.js";import{a as Ee,C as Qe,b as Ze,d as $e}from"./Box0xAD3.js";import{p as et}from"./CKNy4AKM.js";import{P as tt}from"./Aa7ppNik.js";class we{#e=new WeakMap;#t;#n;static entries=new WeakMap;constructor(e){this.#n=e}observe(e,s){var _=this.#e.get(e)||new Set;return _.add(s),this.#e.set(e,_),this.#a().observe(e,this.#n),()=>{var u=this.#e.get(e);u.delete(s),u.size===0&&(this.#e.delete(e),this.#t.unobserve(e))}}#a(){return this.#t??(this.#t=new ResizeObserver(e=>{for(var s of e){we.entries.set(s.target,s);for(var _ of this.#e.get(s.target)||[])_(s)}}))}}var nt=new we({box:"border-box"});function de(n,e,s){var _=nt.observe(n,()=>s(n[e]));He(()=>(Be(()=>s(n[e])),_))}var at=n=>{n.stopPropagation()},st=j('<li role="none" class="svelte-1fkm0gl"><a role="menuitem" tabindex="-1"><div class="content"><div class="icon"><!></div> <div class="title"><span class="text svelte-1fkm0gl"><!></span></div></div></a></li>');function rt(n,e){xe(e,!0);const s=E(e,"disabled",3,!1),_=E(e,"external_rel",3,"noreferrer"),u=Ee.get();let x=V(void 0);const H=u.add_entry(()=>()=>{t(x)&&t(x).click()},()=>s()),U=N(()=>H.disabled()),O=(o,d=location.host)=>{const P=pe(pe(o,"https://"),"http://");return P.startsWith(d+"/")?pe(P,d):P},m=N(()=>O(e.href)),B=N(()=>!(t(m)[0]==="."||t(m)[0]==="/"&&t(m)[1]!=="/")),G=N(()=>t(B)?_():void 0),C=N(()=>et.url.pathname===e.href);var F=st(),f=L(F);let I;f.__click=function(...o){(t(U)?void 0:()=>u.close())?.apply(this,o)},f.__contextmenu=[at];var W=L(f),y=L(W),A=L(y);{var w=o=>{var d=$();Y(()=>ie(d,e.icon)),c(o,d)},X=o=>{var d=g(),P=p(d);{var le=ee=>{var ce=g(),_e=p(ce);D(_e,()=>e.icon),c(ee,ce)};b(P,ee=>{e.icon&&ee(le)},!0)}c(o,d)};b(A,o=>{typeof e.icon=="string"?o(w):o(X,!1)})}k(y);var a=oe(y,2),h=L(a),z=L(h);{var q=o=>{var d=g(),P=p(d);D(P,()=>e.children),c(o,d)},S=o=>{var d=$();Y(()=>ie(d,t(m))),c(o,d)};b(z,o=>{e.children?o(q):o(S,!1)})}k(h),k(a),k(W),k(f),Ae(f,o=>i(x,o),()=>t(x)),k(F),Y(o=>{I=Ce(f,1,"menu_item plain svelte-1fkm0gl",null,I,o),re(f,"aria-disabled",t(U)),re(f,"href",e.href),re(f,"rel",t(G))},[()=>({selected:t(C),disabled:t(U)})]),R("mouseenter",f,function(...o){(t(U)?void 0:d=>{ue(d),u.select(H)})?.apply(this,o)}),c(n,F),ge()}be(["click","contextmenu"]);var ot=j('<li role="menuitem" aria-label="contextmenu entry" tabindex="-1"><div class="content"><div class="icon"><!></div> <div class="title"><!></div> <!></div></li>');function it(n,e){xe(e,!0);const s=E(e,"disabled",3,!1),_=Ee.get(),u=_.add_entry(()=>e.run,()=>s()),x=N(()=>u.selected),H=N(()=>u.pending),U=N(()=>u.error_message),O=N(()=>u.disabled());var m=ot();let B;m.__click=function(...a){(t(O)?void 0:()=>{setTimeout(()=>_.activate(u))})?.apply(this,a)};var G=L(m),C=L(G),F=L(C);{var f=a=>{var h=$();Y(()=>ie(h,e.icon)),c(a,h)},I=a=>{var h=g(),z=p(h);{var q=S=>{var o=g(),d=p(o);D(d,()=>e.icon),c(S,o)};b(z,S=>{e.icon&&S(q)},!0)}c(a,h)};b(F,a=>{typeof e.icon=="string"?a(f):a(I,!1)})}k(C);var W=oe(C,2),y=L(W);D(y,()=>e.children),k(W);var A=oe(W,2);{var w=a=>{tt(a,{})},X=a=>{var h=g(),z=p(h);{var q=S=>{var o=$("⚠️");c(S,o)};b(z,S=>{t(U)&&S(q)},!0)}c(a,h)};b(A,a=>{t(H)?a(w):a(X,!1)})}k(G),k(m),Y(a=>{B=Ce(m,1,"menu_item plain selectable deselectable svelte-q1a8dq",null,B,a),re(m,"aria-disabled",t(O)),re(m,"title",t(U)?`Error: ${t(U)}`:void 0)},[()=>({selected:t(x),disabled:t(O)})]),R("mouseenter",m,function(...a){(t(O)?void 0:h=>{ue(h),_.select(u)})?.apply(this,a)}),c(n,m),ge()}be(["click"]);function lt(n,e){it(n,{get run(){return e.run},icon:_=>{Ne();var u=$();Y(()=>ie(u,e.icon)),c(_,u)},children:(_,u)=>{Ne();var x=$();Y(()=>ie(x,e.content)),c(_,x)},$$slots:{icon:!0,default:!0}})}var ct=j("<li></li>");function _t(n,e){const s=Ke(e,["$$slots","$$events","$$legacy"]);var _=ct();Ge(_,()=>({role:"separator","aria-orientation":"vertical",...s,[Ve]:{contextmenu_separator:!0}}),void 0,void 0,"svelte-89x3rn"),c(n,_)}const dt=-2,ut=-2,vt=750,ft=11,Dt=633,Xt=21,Oe=(n,e)=>!e&&(n instanceof HTMLElement||n instanceof SVGElement)&&!Se(n)&&!Je(n),mt=n=>new Map([["Escape",()=>n.close()],["ArrowLeft",()=>n.collapse_selected()],["ArrowRight",()=>n.expand_selected()],["ArrowDown",()=>n.select_next()],["ArrowUp",()=>n.select_previous()],["Home",()=>n.select_first()],["End",()=>n.select_last()],[" ",()=>n.activate_selected()],["Enter",()=>n.activate_selected()]]),ht=n=>e=>{const s=n.get(e.key);!s||Se(e.target)||(ue(e),s())},pt=(n,e,s)=>n+Math.min(0,s-(n+e)),xt=(n,e,s)=>n+Math.min(0,s-(n+e)),gt=(n,e=Z)=>{rt(n,ye(e))},bt=(n,e=Z)=>{lt(n,ye(e))},yt=(n,e=Z)=>{_t(n,ye(e))};var Et=j('<div class="contextmenu_root svelte-1mc2pnq" role="region"><!></div>'),wt=j('<div class="contextmenu_layout svelte-1mc2pnq" aria-hidden="true"></div>'),Tt=j('<ul class="contextmenu unstyled pane svelte-1mc2pnq" role="menu" aria-label="context menu" tabindex="-1"></ul>'),kt=j("<!> <!>  <!>",1);function Rt(n,e){xe(e,!0);const s=E(e,"contextmenu",19,()=>new Qe),_=E(e,"open_offset_x",3,dt),u=E(e,"open_offset_y",3,ut),x=E(e,"bypass_with_tap_then_longpress",3,!0),H=E(e,"bypass_window",3,vt),U=E(e,"bypass_move_tolerance",3,ft),O=E(e,"scoped",3,!1),m=E(e,"link_entry",3,gt),B=E(e,"text_entry",3,bt),G=E(e,"separator_entry",3,yt);Ee.set(s());let C=V(void 0);const F=N(()=>s().layout),f=Ze.set(),I=N(()=>pt(s().x,f.width,t(F).width)),W=N(()=>xt(s().y,f.height,t(F).height));let y=V(void 0),A=V(void 0),w=V(void 0),X=V(void 0),a=V(void 0);const h=r=>{if(t(X)){i(X,!1),i(w,null),i(y,null),i(A,null),t(a)!=null&&(clearTimeout(t(a)),i(a,null));return}const{target:l}=r;Oe(l,r.shiftKey)&&(t(C)?.contains(l)||$e(l,r.clientX+_(),r.clientY+u(),s(),{link_enabled:m()!==null,text_enabled:B()!==null,separator_enabled:G()!==null})&&ue(r))},z=r=>{if(!x())return;const{touches:l,target:T}=r;if(s().opened||l.length!==1||!Oe(T,r.shiftKey)){i(w,null),i(y,null),i(A,null),i(X,!1),t(a)!=null&&(clearTimeout(t(a)),i(a,null));return}const{clientX:v,clientY:M}=l[0];if(t(w)!=null&&performance.now()-t(w)<H()&&Math.hypot(v-t(y),M-t(A))<U()){i(X,!0),i(w,null),i(y,null),i(A,null),t(a)!=null&&(clearTimeout(t(a)),i(a,null));return}i(w,performance.now(),!0),i(y,v,!0),i(A,M,!0),t(a)!=null&&clearTimeout(t(a)),i(a,setTimeout(()=>{i(w,null),i(y,null),i(A,null),i(a,null)},H()),!0)},q=()=>{i(w,null),i(y,null),i(A,null),i(X,!1),t(a)!=null&&(clearTimeout(t(a)),i(a,null))},S=r=>{t(C)&&!t(C).contains(r.target)&&s().close()},o=mt(s()),d=ht(o);var P=kt();R("contextmenu",se,function(...r){(O()?void 0:h)?.apply(this,r)}),R("mousedown",se,function(...r){(s().opened?S:void 0)?.apply(this,r)}),R("keydown",se,function(...r){(s().opened?d:void 0)?.apply(this,r)}),R("touchstart",se,function(...r){(O()||!x()?void 0:z)?.apply(this,r)},!0,!0),R("touchcancel",se,function(...r){(O()||!x()?void 0:q)?.apply(this,r)},!0);var le=p(P);{var ee=r=>{var l=Et();l.__contextmenu=h;var T=L(l);D(T,()=>e.children),k(l),R("touchstart",l,function(...v){(x()?z:void 0)?.apply(this,v)},!0,!0),R("touchcancel",l,function(...v){(x()?q:void 0)?.apply(this,v)},!0),c(r,l)},ce=r=>{var l=g(),T=p(l);D(T,()=>e.children),c(r,l)};b(le,r=>{O()?r(ee):r(ce,!1)})}var _e=oe(le,2);{var Me=r=>{var l=wt();de(l,"clientWidth",T=>t(F).width=T),de(l,"clientHeight",T=>t(F).height=T),c(r,l)};b(_e,r=>{s().has_custom_layout||r(Me)})}var Le=oe(_e,2);{var Ue=r=>{var l=Tt();let T;je(l,20,()=>s().params,v=>v,(v,M)=>{var Te=g(),Fe=p(Te);{var Pe=K=>{var te=g(),ve=p(te);D(ve,()=>M),c(K,te)},De=K=>{var te=g(),ve=p(te);{var Xe=J=>{var ne=g(),fe=p(ne);D(fe,()=>m()??Z,()=>M.props),c(J,ne)},Re=J=>{var ne=g(),fe=p(ne);{var We=Q=>{var ae=g(),me=p(ae);D(me,()=>B()??Z,()=>M.props),c(Q,ae)},ze=Q=>{var ae=g(),me=p(ae);{var qe=he=>{var ke=g(),Ye=p(ke);D(Ye,()=>G()??Z,()=>M.props),c(he,ke)};b(me,he=>{M.snippet==="separator"&&he(qe)},!0)}c(Q,ae)};b(fe,Q=>{M.snippet==="text"?Q(We):Q(ze,!1)},!0)}c(J,ne)};b(ve,J=>{M.snippet==="link"?J(Xe):J(Re,!1)},!0)}c(K,te)};b(Fe,K=>{typeof M=="function"?K(Pe):K(De,!1)})}c(v,Te)}),k(l),Ae(l,v=>i(C,v),()=>t(C)),Y(v=>T=Ie(l,"",T,v),[()=>({transform:`translate3d(${t(I)??""}px, ${t(W)??""}px, 0)`})]),de(l,"offsetWidth",v=>f.width=v),de(l,"offsetHeight",v=>f.height=v),c(r,l)};b(Le,r=>{s().opened&&r(Ue)})}c(n,P),ge()}be(["contextmenu"]);export{Rt as C,Xt as a,Dt as b,vt as c,ft as d,dt as e,ut as f,mt as g,rt as h,lt as i,_t as j,ht as k,Oe as l,de as m,pt as n,xt as o,it as p};
