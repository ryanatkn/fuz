import"./DsnmJJEf.js";import{p as de,f as l,h as a,au as H,d as n,r,b as s,c as ce,at as B,e as me,a as A,g as xe,s as e,t as ne,aV as Se,ay as _e,u as R,ar as M,aq as j,ap as ke}from"./hvi78P_d.js";import{i as F}from"./b9UmUbIo.js";import{C as W}from"./BK81am7X.js";import{r as Ce,t as Ie,d as ze}from"./B_5c0ZTf.js";import{T as Pe}from"./BMnVpRjX.js";import{D as le}from"./B0ito0-D.js";import{s as ye,D as ge}from"./B1kFDkno.js";import{g as Me}from"./DKsCkxQO.js";import{C as We,T as Ae}from"./BnSb2My4.js";import{T as ae,a as re}from"./Df4omOdi.js";import{s as ie}from"./DcnXoHJa.js";import{e as Be}from"./gGLiu_OD.js";import{a as De,C as Ee,r as he,e as fe}from"./baBGA4xI.js";import{b as $e}from"./BA0GZFwj.js";import{p as ve}from"./Cu6gSB0G.js";import{t as be,b as qe,s as Fe}from"./CxTF7-PZ.js";import{M as se}from"./BPa6Dq2O.js";var Le=l("<div>✓</div>"),Ne=l("<div>⧉</div>"),Oe=l("<button><!></button>");function Re(S,o){de(o,!0);const m=ve(o,"copied_display_duration",3,1e3),k=ve(o,"icon_button",3,!0);let h=H(!1),_=H(!1),y;const D=async c=>{if(clearTimeout(y),o.text!==null){B(h,!1),B(_,!1);try{await navigator.clipboard.writeText(o.text),B(h,!0)}catch{B(_,!0);return}y=setTimeout(()=>{B(h,!1)},m()),o.oncopy?.(o.text,c)}};var C=Oe();De(C,c=>({type:"button",title:"copy to clipboard",...o.attrs,class:o.attrs?.class,onclick:D,disabled:o.attrs?.disabled??(o.allow_copying_empty_string?o.text===null:!o.text),[Ee]:c}),[()=>({icon_button:o.children?!1:k(),copied:a(h),failed:a(_),color_c:a(_)})]);var E=n(C);{var L=c=>{var f=me(),v=A(f);xe(v,()=>o.children,()=>a(h),()=>a(_)),s(c,f)},I=c=>{var f=me(),v=A(f);{var g=b=>{var P=Le();be(1,P,()=>qe,()=>({duration:200})),s(b,P)},z=b=>{var P=Ne();be(1,P,()=>Fe),s(b,P)};F(v,b=>{a(h)?b(g):b(z,!1)},!0)}s(c,f)};F(E,c=>{o.children?c(L):c(I,!1)})}r(C),s(S,C),ce()}var Je=l("<blockquote> </blockquote>"),je=l('<div class="variable svelte-yyt8da"><div class="name svelte-yyt8da"><code> </code></div> <!> <label><div class="title">light</div> <input disabled/></label> <label><div class="title">dark</div> <input disabled/></label></div>');function Ve(S,o){de(o,!0);var m=me(),k=A(m);{var h=_=>{var y=je(),D=n(y),C=n(D),E=n(C);r(C),r(D);var L=e(D,2);{var I=z=>{var b=Je(),P=n(b,!0);r(b),ne(()=>ie(P,o.variable.summary)),s(z,b)};F(L,z=>{o.variable.summary&&z(I)})}var c=e(L,2),f=e(n(c),2);he(f),r(c);var v=e(c,2),g=e(n(v),2);he(g),r(v),r(y),ne(()=>{ie(E,`--${o.variable.name??""}`),fe(f,o.variable.light??""),fe(g,o.variable.dark??"")}),s(_,y)};F(k,_=>{o.variable&&_(h)})}s(S,m),ce()}const Ye=(S,o,m,k)=>{a(o)&&m.onsave?.(a(k))},He=S=>{ye(S),alert("TODO")};var Ue=(S,o,m)=>o(S,a(m)),Ge=l('<button type="button" class="variable menu_item svelte-cno0i6"> </button>'),Ke=l('<div class="copy svelte-cno0i6"><!></div> <!>',1),Qe=l('<div class="pane p_md width_md mx_auto"><div class="panel p_lg box"><!> <aside>⚠️ This is unfinished and will change.</aside> <button type="button">ok</button></div></div>'),Xe=l('<div class="theme_form svelte-cno0i6"><h2 class="text_align_center"><!> theme</h2> <aside>⚠️ Creating and editing themes at runtime is a work in progress i.e. totally unfinished.</aside> <header class="svelte-cno0i6"><div class="variables_header svelte-cno0i6"><p> </p> <button type="button" class="w_100" disabled>add a variable</button></div> <form class="svelte-cno0i6"><label><div class="title">name</div> <input placeholder=">"/></label> <button type="button"><!></button></form></header> <div class="content svelte-cno0i6"><div class="variables svelte-cno0i6"></div> <div class="rendered svelte-cno0i6"><!></div></div></div> <!>',1);function Ze(S,o){de(o,!0);const m=ve(o,"theme",3,null);let k=H(_e(m()?m().name:"new theme")),h=H(_e(m()?m().variables:[]));const _=R(()=>({name:a(k),variables:a(h)})),y=R(()=>Ce(a(_),{empty_default_theme:!1,specificity:1})),D=R(()=>a(h).reduce((t,i)=>i.light?t+1:t,0)),C=R(()=>a(h).reduce((t,i)=>i.dark?t+1:t,0));let E=H(null);const L=(t,i)=>{ye(t),B(E,i,!0),B(h,a(h).slice(),!0)},I=R(()=>!!m()),c=R(()=>m()?a(k)!==m().name||a(h)!==m().variables:!0);var f=Xe(),v=A(f),g=n(v),z=n(g);{var b=t=>{var i=j("edit");s(t,i)},P=t=>{var i=j("create");s(t,i)};F(z,t=>{a(I)?t(b):t(P,!1)})}M(),r(g);var V=e(g,4),Y=n(V),U=n(Y),X=n(U);r(U);var Z=e(U,2);Z.__click=[He],r(Y);var G=e(Y,2),K=n(G),T=e(n(K),2);he(T),r(K);var p=e(K,2);p.__click=[Ye,c,o,_];var d=n(p);{var u=t=>{var i=j("save changes");s(t,i)},x=t=>{var i=j("create theme");s(t,i)};F(d,t=>{a(I)?t(u):t(x,!1)})}r(p),r(G),r(V);var $=e(V,2),q=n($);Be(q,21,()=>a(h),t=>t.name,(t,i)=>{var w=Ge();w.__click=[Ue,L,i];var O=n(w);r(w),ne(()=>ie(O,`--${a(i).name??""}`)),s(t,w)}),r(q);var N=e(q,2),Q=n(N);{var ee=t=>{var i=Ke(),w=A(i),O=n(w);Re(O,{get text(){return a(y)}}),r(w);var J=e(w,2);W(J,{get content(){return a(y)},lang:"css"}),s(t,i)};F(Q,t=>{a(y)&&t(ee)})}r(N),r($),r(v);var te=e(v,2);{var oe=t=>{ge(t,{onclose:()=>B(E,null),children:(w,O=ke)=>{var J=Qe(),ue=n(J),pe=n(ue);Ve(pe,{get variable(){return a(E)}});var Te=e(pe,4);Te.__click=function(...we){O()?.apply(this,we)},r(ue),r(J),s(w,J)},$$slots:{default:!0}})};F(te,t=>{a(E)&&t(oe)})}ne(()=>{ie(X,`variables: ${a(D)??""} light, ${a(C)??""} dark`),p.disabled=!a(c)}),$e(T,()=>a(k),t=>B(k,t)),s(S,f),ce()}Se(["click"]);var et=l(`<aside><p>Most theme usage affects the whole page, so Fuz makes that easy.</p> <p>By default <code>Themed</code> syncs its settings to the global <code>:root</code> tag and
					persists to <code>localStorage</code>.</p> <p>These behaviors can be customized with its props:</p> <ul><li><code>sync_color_scheme</code></li> <li><code>load_color_scheme</code></li> <li><code>save_color_scheme</code></li> <li><code>load_theme</code></li> <li><code>save_theme</code></li></ul> <p>A feature to support partial page theming is planned with <code>Themed_Scope</code>.</p></aside>`),tt=l(`<aside><p><code>Themed</code> is designed to wrap every page at the top level so it can provide the
					selected theme and color scheme in the Svelte context via a <code>themer</code> instance.
					It works without children, but <code>themer_context.get()</code> will fail unless you call <code>themer_context.set()</code> yourself.</p> <p>This lets you call <code>themer_context.get()</code> to access the reactive <code>Themer</code> class instance anywhere in your code. The helper components on this page like <code>Color_Scheme_Input</code> and <code>Theme_Input</code> use it so they don't require
					a <code>themer</code> prop.</p> <p>If you don't don't want to wrap everything in <code>Themed</code> for some reason, you can
					set a <code>Themer</code> in context manually. It must be the same reference as the <code>Themed</code> prop:</p> <!></aside>`),ot=l("More about <code>Color_Scheme_Input</code>",1),at=l(`<aside><p><code>Color_Scheme_Input</code> enables users to choose and persist the color scheme without
					boilerplate.</p> <p>By default, <code>Color_Scheme_Input</code> works with <code>Themed</code>'s <code>themer</code> in context to save the user's preference to <code>localStorage</code>.
					To customize this behavior, pass your own <code>value</code> or <code>onchange</code> props. The <code>value</code> defaults to <code>themer_context.get()</code> so technically
					you could call <code>set_themer</code>, but it's unlikely you want to override it in
					context.</p></aside>`),rt=l(`<!> <p><code>Themed</code> defaults to automatic <!> detection with <!>, and users can also set it directly:</p> <div class="mb_lg"><!></div> <!> <!> <p>Pass props to override the default:</p> <!> <p>The builtin themes support both dark and light color schemes. Custom themes may support one or
			both color schemes.</p> <!>`,1),st=l(`<!> <p>A theme is a simple JSON collection of <a href="https://moss.ryanatkn.com/docs/variables">Moss style variables</a> that can be transformed into CSS that set custom properties. Each variable can have values for
			light and/or dark color schemes. In other words, "dark" isn't a theme, it's a mode that any theme
			can implement.</p> <div class="width_sm mb_lg"><!></div> <aside>⚠️ The builtin themes need a lot more work, but the proof of concept seems to work.</aside> <aside>⚠️ Custom themes currently pop in on page load. To see this, change from the base theme and
			refresh the page. This can be fixed using a similar strategy that we use to avoid pop-in of
			user-defined color schemes, but it's more involved.</aside>`,1),nt=l(`<!> <p>Themes are plain CSS that can be sourced in a variety of ways.</p> <p>To use Fuz's base theme:</p> <!> <p><code>Themed</code> can be customized with the the nonreactive prop <code>themer</code>:</p> <!> <!> <aside>The <code>themer</code> prop is not reactive because it's put in Svelte context without a wrapper.
			This could be fixed, let me know if you have a usecase.</aside> <p><code>Themed</code> sets the <code>themer</code> in the Svelte context:</p> <!> <p>For a more complete example, see <a href="https://github.com/ryanatkn/fuz_template">fuz_template</a>.</p>`,1),it=l(`<!> <p><code>Themed</code> initializes the system's theme support. Without it, the page will not
			reflect the user's system <code>color-scheme</code>. By default, <code>Themed</code> applies the base theme to the root
			of the page via <code>create_theme_setup_script</code>. It uses JS to add the <code>.dark</code> CSS class to the <code>:root</code> element.</p> <p>This strategy enables color scheme and theme support with minimal CSS and optimal performance
			for most use cases. The system supports plain CSS usage that can be static or dynamic, or
			imported at buildtime or runtime. It also allows runtime access to the underlying data like
			the <a href="https://moss.ryanatkn.com/docs/variables">style variables</a> if you want to pay the
			performance costs. Scoped theming to one part of the page is planned.</p> <p>The theme setup script interacts with <code>sync_color_scheme</code> to save the user's
			preference to <code>localStorage</code>. See also <code>Color_Scheme_Input</code>.</p> <p>The setup script avoids flash-on-load due to color scheme, but currently themes flash in after
			loading. We'll try to fix this when the system stabilizes.</p>`,1),dt=l(`<section class="theme"><p>Fuz provides UI components that use <a href="https://moss.ryanatkn.com/docs/themes">Moss' theming system</a> for dark mode and custom themes.</p> <p><code>Themed</code> adds global support for both the browser's <!> and custom themes based on <a href="https://moss.ryanatkn.com/docs/variables">Moss style variables</a>, which use <!>. <code>Themed</code> is a singleton component that's mounted at the top-level of the page:</p> <!> <!> <!> <!></section> <!> <!> <!> <!>`,1),ct=l('<div class="pane p_md width_md mx_auto"><div class="theme_editor_wrapper panel svelte-1hpy1za"><!></div></div>'),lt=l("<!>  <!>",1);function Pt(S,o){de(o,!0);const k=Me("Themed"),h=ze.slice(),_=Ie.get();let y=H(null);var D=lt(),C=A(D);Pe(C,{get tome(){return k},children:(I,c)=>{var f=dt(),v=A(f),g=e(n(v),2),z=e(n(g),2);se(z,{path:"Web/CSS/color-scheme"});var b=e(z,4);se(b,{path:"Web/CSS/--*",children:(T,p)=>{M();var d=j("CSS custom properties");s(T,d)},$$slots:{default:!0}}),M(3),r(g);var P=e(g,2);W(P,{content:"import Themed from '@ryanatkn/fuz/Themed.svelte';",lang:"ts"});var V=e(P,2);W(V,{content:`<!-- +layout.svelte -->
<Themed>
	{@render children()}
</Themed>`});var Y=e(V,2);le(Y,{summary:p=>{M();var d=j("Why the singleton?");s(p,d)},children:(p,d)=>{var u=et();s(p,u)},$$slots:{summary:!0,default:!0}});var U=e(Y,2);le(U,{summary:p=>{M();var d=j("Why nested children?");s(p,d)},children:(p,d)=>{var u=tt(),x=e(n(u),6);W(x,{content:`<script>
	const themer = new Themer(...);
	set_themer(themer);
<\/script>
<Themed {themer} />
<!--
	sibling components not nested in \`Themed\`
	can now call \`themer_context.get()\`
-->`}),r(u),s(p,u)},$$slots:{summary:!0,default:!0}}),r(v);var X=e(v,2);ae(X,{children:(T,p)=>{var d=rt(),u=A(d);re(u,{text:"Color scheme"});var x=e(u,2),$=e(n(x),2);se($,{path:"Web/CSS/color-scheme"});var q=e($,2);se(q,{path:"Web/CSS/@media/prefers-color-scheme"}),M(),r(x);var N=e(x,2),Q=n(N);We(Q,{}),r(N);var ee=e(N,2);W(ee,{content:"import Color_Scheme_Input from '@ryanatkn/fuz/Color_Scheme_Input.svelte';",lang:"ts"});var te=e(ee,2);W(te,{content:"<Color_Scheme_Input />"});var oe=e(te,4);{let i=R(()=>`<Color_Scheme_Input
	value={{color_scheme: ${"'"+JSON.stringify(_.color_scheme).replace(/"/g,"")+"'"}}}
	onchange={...}
/>`);W(oe,{get content(){return a(i)}})}var t=e(oe,4);le(t,{summary:w=>{M();var O=ot();M(),s(w,O)},children:(w,O)=>{var J=at();s(w,J)},$$slots:{summary:!0,default:!0}}),s(T,d)},$$slots:{default:!0}});var Z=e(X,2);ae(Z,{children:(T,p)=>{var d=st(),u=A(d);re(u,{text:"Builtin themes"});var x=e(u,4),$=n(x);Ae($,{get themes(){return h},enable_editing:!0,onedit:q=>B(y,q,!0)}),r(x),M(4),s(T,d)},$$slots:{default:!0}});var G=e(Z,2);ae(G,{children:(T,p)=>{var d=nt(),u=A(d);re(u,{text:"Example usage"});var x=e(u,6);W(x,{content:`<!-- +layout.svelte -->
<script>
	import '@ryanatkn/moss/style.css';
	import '@ryanatkn/moss/theme.css';
	import Themed from '@ryanatkn/fuz/Themed.svelte';
	import type {Snippet} from 'svelte';

	interface Props {
		children: Snippet;
	}
	
	const {children}: Props = $props();
<\/script>

<!-- enable theme and color-scheme support -->
<Themed>
	{@render children()}
</Themed>`});var $=e(x,4);W($,{content:`import {Themer} from '@ryanatkn/fuz/themer.svelte.js';
const themer = new Themer(...);`,lang:"ts"});var q=e($,2);W(q,{content:`<Themed {themer}>
	{@render children()}
</Themed>`});var N=e(q,6);{let Q=R(()=>`// get values from the Svelte context provided by
// the nearest \`Themed\` ancestor:
import {themer_context} from '@ryanatkn/fuz/themer.svelte.js';
const themer = themer_context.get();
themer.theme.name; // '${_.theme.name}'
themer.color_scheme; // '${_.color_scheme}'`);W(N,{get content(){return a(Q)},lang:"ts"})}M(2),s(T,d)},$$slots:{default:!0}});var K=e(G,2);ae(K,{children:(T,p)=>{var d=it(),u=A(d);re(u,{text:"More details"}),M(8),s(T,d)},$$slots:{default:!0}}),s(I,f)},$$slots:{default:!0}});var E=e(C,2);{var L=I=>{ge(I,{onclose:()=>B(y,null),children:(c,f)=>{var v=ct(),g=n(v),z=n(g);Ze(z,{get theme(){return a(y)},onsave:b=>{console.log("update theme",b),alert("todo")}}),r(g),r(v),s(c,v)},$$slots:{default:!0}})};F(E,I=>{a(y)&&I(L)})}s(S,D),ce()}export{Ve as S,Pt as _};
