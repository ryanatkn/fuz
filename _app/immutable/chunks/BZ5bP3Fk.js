import"./DsnmJJEf.js";import{U as He,z as Be,p as xe,i as t,aC as V,f as j,d as U,u as N,s as ie,t as Y,aD as R,b as c,c as ge,r as k,ar as o,aB as be,a8 as $,e as oe,g,a as p,h as P,n as Ne,ak as Z,aE as se}from"./DFPGRpXC.js";import{h as Ce,s as re,b as pe,d as Ge,C as Ve,e as je,j as Ie}from"./BcAAJJP1.js";import{i as b}from"./B9dAxPDU.js";import{b as Ae}from"./uyiARXNM.js";import{p as E,r as Ke,s as ye}from"./Cn9cylxT.js";import{s as ue,i as Se,a as Je}from"./V2q5a4YM.js";import{a as Ee,C as Qe,b as Ze,d as $e}from"./DXrlyc2B.js";import{p as et}from"./PMcUNylz.js";import{P as tt}from"./BmqarjP0.js";class we{#e=new WeakMap;#t;#n;static entries=new WeakMap;constructor(e){this.#n=e}observe(e,a){var _=this.#e.get(e)||new Set;return _.add(a),this.#e.set(e,_),this.#a().observe(e,this.#n),()=>{var u=this.#e.get(e);u.delete(a),u.size===0&&(this.#e.delete(e),this.#t.unobserve(e))}}#a(){return this.#t??(this.#t=new ResizeObserver(e=>{for(var a of e){we.entries.set(a.target,a);for(var _ of this.#e.get(a.target)||[])_(a)}}))}}var nt=new we({box:"border-box"});function de(n,e,a){var _=nt.observe(n,()=>a(n[e]));He(()=>(Be(()=>a(n[e])),_))}var at=j('<li role="none" class="svelte-1fkm0gl"><a role="menuitem" tabindex="-1"><div class="content"><div class="icon"><!></div> <div class="title"><span class="text svelte-1fkm0gl"><!></span></div></div></a></li>');function st(n,e){xe(e,!0);const a=E(e,"disabled",3,!1),_=E(e,"external_rel",3,"noreferrer"),u=Ee.get();let x=V(void 0);const H=u.add_entry(()=>()=>{t(x)&&t(x).click()},()=>a()),L=N(()=>H.disabled()),O=(i,d=location.host)=>{const F=pe(pe(i,"https://"),"http://");return F.startsWith(d+"/")?pe(F,d):F},f=N(()=>O(e.href)),B=N(()=>!(t(f)[0]==="."||t(f)[0]==="/"&&t(f)[1]!=="/")),G=N(()=>t(B)?_():void 0),C=N(()=>et.url.pathname===e.href);var D=at(),v=U(D);let I;v.__click=function(...i){(t(L)?void 0:()=>u.close())?.apply(this,i)},v.__contextmenu=i=>{i.stopPropagation()};var W=U(v),y=U(W),A=U(y);{var w=i=>{var d=$();Y(()=>oe(d,e.icon)),c(i,d)},X=i=>{var d=g(),F=p(d);{var le=ee=>{var ce=g(),_e=p(ce);P(_e,()=>e.icon),c(ee,ce)};b(F,ee=>{e.icon&&ee(le)},!0)}c(i,d)};b(A,i=>{typeof e.icon=="string"?i(w):i(X,!1)})}k(y);var s=ie(y,2),m=U(s),q=U(m);{var z=i=>{var d=g(),F=p(d);P(F,()=>e.children),c(i,d)},S=i=>{var d=$();Y(()=>oe(d,t(f))),c(i,d)};b(q,i=>{e.children?i(z):i(S,!1)})}k(m),k(s),k(W),k(v),Ae(v,i=>o(x,i),()=>t(x)),k(D),Y(()=>{I=Ce(v,1,"menu_item plain svelte-1fkm0gl",null,I,{selected:t(C),disabled:t(L)}),re(v,"aria-disabled",t(L)),re(v,"href",e.href),re(v,"rel",t(G))}),R("mouseenter",v,function(...i){(t(L)?void 0:d=>{ue(d),u.select(H)})?.apply(this,i)}),c(n,D),ge()}be(["click","contextmenu"]);var rt=j('<li role="menuitem" aria-label="contextmenu entry" tabindex="-1"><div class="content"><div class="icon"><!></div> <div class="title"><!></div> <!></div></li>');function it(n,e){xe(e,!0);const a=E(e,"disabled",3,!1),_=Ee.get(),u=_.add_entry(()=>e.run,()=>a()),x=N(()=>u.selected),H=N(()=>u.pending),L=N(()=>u.error_message),O=N(()=>u.disabled());var f=rt();let B;f.__click=function(...s){(t(O)?void 0:()=>{setTimeout(()=>_.activate(u))})?.apply(this,s)};var G=U(f),C=U(G),D=U(C);{var v=s=>{var m=$();Y(()=>oe(m,e.icon)),c(s,m)},I=s=>{var m=g(),q=p(m);{var z=S=>{var i=g(),d=p(i);P(d,()=>e.icon),c(S,i)};b(q,S=>{e.icon&&S(z)},!0)}c(s,m)};b(D,s=>{typeof e.icon=="string"?s(v):s(I,!1)})}k(C);var W=ie(C,2),y=U(W);P(y,()=>e.children),k(W);var A=ie(W,2);{var w=s=>{tt(s,{})},X=s=>{var m=g(),q=p(m);{var z=S=>{var i=$("⚠️");c(S,i)};b(q,S=>{t(L)&&S(z)},!0)}c(s,m)};b(A,s=>{t(H)?s(w):s(X,!1)})}k(G),k(f),Y(()=>{B=Ce(f,1,"menu_item plain selectable deselectable svelte-q1a8dq",null,B,{selected:t(x),disabled:t(O)}),re(f,"aria-disabled",t(O)),re(f,"title",t(L)?`Error: ${t(L)}`:void 0)}),R("mouseenter",f,function(...s){(t(O)?void 0:m=>{ue(m),_.select(u)})?.apply(this,s)}),c(n,f),ge()}be(["click"]);function ot(n,e){it(n,{get run(){return e.run},icon:_=>{Ne();var u=$();Y(()=>oe(u,e.icon)),c(_,u)},children:(_,u)=>{Ne();var x=$();Y(()=>oe(x,e.content)),c(_,x)},$$slots:{icon:!0,default:!0}})}var lt=j("<li></li>");function ct(n,e){const a=Ke(e,["$$slots","$$events","$$legacy"]);var _=lt();Ge(_,()=>({role:"separator","aria-orientation":"vertical",...a,[Ve]:{contextmenu_separator:!0}}),void 0,void 0,void 0,"svelte-89x3rn"),c(n,_)}const _t=-2,dt=-2,ut=750,vt=11,Ft=633,Pt=21,Oe=(n,e)=>!e&&(n instanceof HTMLElement||n instanceof SVGElement)&&!Se(n)&&!Je(n),ft=n=>new Map([["Escape",()=>n.close()],["ArrowLeft",()=>n.collapse_selected()],["ArrowRight",()=>n.expand_selected()],["ArrowDown",()=>n.select_next()],["ArrowUp",()=>n.select_previous()],["Home",()=>n.select_first()],["End",()=>n.select_last()],[" ",()=>n.activate_selected()],["Enter",()=>n.activate_selected()]]),mt=n=>e=>{const a=n.get(e.key);!a||Se(e.target)||(ue(e),a())},ht=(n,e,a)=>n+Math.min(0,a-(n+e)),pt=(n,e,a)=>n+Math.min(0,a-(n+e)),xt=(n,e=Z)=>{st(n,ye(e))},gt=(n,e=Z)=>{ot(n,ye(e))},bt=(n,e=Z)=>{ct(n,ye(e))};var yt=j('<div class="contextmenu_root svelte-1mc2pnq" role="region"><!></div>'),Et=j('<div class="contextmenu_layout svelte-1mc2pnq" aria-hidden="true"></div>'),wt=j('<ul class="contextmenu unstyled pane svelte-1mc2pnq" role="menu" aria-label="context menu" tabindex="-1"></ul>'),Tt=j("<!> <!>  <!>",1);function Xt(n,e){xe(e,!0);const a=E(e,"contextmenu",19,()=>new Qe),_=E(e,"open_offset_x",3,_t),u=E(e,"open_offset_y",3,dt),x=E(e,"bypass_with_tap_then_longpress",3,!0),H=E(e,"bypass_window",3,ut),L=E(e,"bypass_move_tolerance",3,vt),O=E(e,"scoped",3,!1),f=E(e,"link_entry",3,xt),B=E(e,"text_entry",3,gt),G=E(e,"separator_entry",3,bt);Ee.set(a());let C=V(void 0);const D=N(()=>a().layout),v=Ze.set(),I=N(()=>ht(a().x,v.width,t(D).width)),W=N(()=>pt(a().y,v.height,t(D).height));let y=V(void 0),A=V(void 0),w=V(void 0),X=V(void 0),s=V(void 0);const m=r=>{if(t(X)){o(X,!1),o(w,null),o(y,null),o(A,null),t(s)!=null&&(clearTimeout(t(s)),o(s,null));return}const{target:l}=r;Oe(l,r.shiftKey)&&(t(C)?.contains(l)||$e(l,r.clientX+_(),r.clientY+u(),a(),{link_enabled:f()!==null,text_enabled:B()!==null,separator_enabled:G()!==null})&&ue(r))},q=r=>{if(!x())return;const{touches:l,target:T}=r;if(a().opened||l.length!==1||!Oe(T,r.shiftKey)){o(w,null),o(y,null),o(A,null),o(X,!1),t(s)!=null&&(clearTimeout(t(s)),o(s,null));return}const{clientX:h,clientY:M}=l[0];if(t(w)!=null&&performance.now()-t(w)<H()&&Math.hypot(h-t(y),M-t(A))<L()){o(X,!0),o(w,null),o(y,null),o(A,null),t(s)!=null&&(clearTimeout(t(s)),o(s,null));return}o(w,performance.now(),!0),o(y,h,!0),o(A,M,!0),t(s)!=null&&clearTimeout(t(s)),o(s,setTimeout(()=>{o(w,null),o(y,null),o(A,null),o(s,null)},H()),!0)},z=()=>{o(w,null),o(y,null),o(A,null),o(X,!1),t(s)!=null&&(clearTimeout(t(s)),o(s,null))},S=r=>{t(C)&&!t(C).contains(r.target)&&a().close()},i=ft(a()),d=mt(i);var F=Tt();R("contextmenu",se,function(...r){(O()?void 0:m)?.apply(this,r)}),R("mousedown",se,function(...r){(a().opened?S:void 0)?.apply(this,r)}),R("keydown",se,function(...r){(a().opened?d:void 0)?.apply(this,r)}),R("touchstart",se,function(...r){(O()||!x()?void 0:q)?.apply(this,r)},!0,!0),R("touchcancel",se,function(...r){(O()||!x()?void 0:z)?.apply(this,r)},!0);var le=p(F);{var ee=r=>{var l=yt();l.__contextmenu=m;var T=U(l);P(T,()=>e.children),k(l),R("touchstart",l,function(...h){(x()?q:void 0)?.apply(this,h)},!0,!0),R("touchcancel",l,function(...h){(x()?z:void 0)?.apply(this,h)},!0),c(r,l)},ce=r=>{var l=g(),T=p(l);P(T,()=>e.children),c(r,l)};b(le,r=>{O()?r(ee):r(ce,!1)})}var _e=ie(le,2);{var Me=r=>{var l=Et();de(l,"clientWidth",T=>t(D).width=T),de(l,"clientHeight",T=>t(D).height=T),c(r,l)};b(_e,r=>{a().has_custom_layout||r(Me)})}var Ue=ie(_e,2);{var Le=r=>{var l=wt();let T;je(l,20,()=>a().params,h=>h,(h,M)=>{var Te=g(),De=p(Te);{var Fe=K=>{var te=g(),ve=p(te);P(ve,()=>M),c(K,te)},Pe=K=>{var te=g(),ve=p(te);{var Xe=J=>{var ne=g(),fe=p(ne);P(fe,()=>f()??Z,()=>M.props),c(J,ne)},Re=J=>{var ne=g(),fe=p(ne);{var We=Q=>{var ae=g(),me=p(ae);P(me,()=>B()??Z,()=>M.props),c(Q,ae)},qe=Q=>{var ae=g(),me=p(ae);{var ze=he=>{var ke=g(),Ye=p(ke);P(Ye,()=>G()??Z,()=>M.props),c(he,ke)};b(me,he=>{M.snippet==="separator"&&he(ze)},!0)}c(Q,ae)};b(fe,Q=>{M.snippet==="text"?Q(We):Q(qe,!1)},!0)}c(J,ne)};b(ve,J=>{M.snippet==="link"?J(Xe):J(Re,!1)},!0)}c(K,te)};b(De,K=>{typeof M=="function"?K(Fe):K(Pe,!1)})}c(h,Te)}),k(l),Ae(l,h=>o(C,h),()=>t(C)),Y(()=>T=Ie(l,"",T,{transform:`translate3d(${t(I)??""}px, ${t(W)??""}px, 0)`})),de(l,"offsetWidth",h=>v.width=h),de(l,"offsetHeight",h=>v.height=h),c(r,l)};b(Ue,r=>{a().opened&&r(Le)})}c(n,F),ge()}be(["contextmenu"]);export{Xt as C,Pt as a,Ft as b,ut as c,vt as d,_t as e,dt as f,ft as g,st as h,ot as i,ct as j,mt as k,Oe as l,de as m,ht as n,pt as o,it as p};
